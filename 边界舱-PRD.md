# 「边界舱」iOS App 项目需求文档 (PRD)

## 一、项目概述

**项目名称**：边界舱 (Boundary Capsule)  
**核心目标**：通过**结构化、异步、低压力**的沟通工具，帮助亲密关系中的双方减少摩擦、保护个人空间、并增进理解。  
**目标用户**：重视个人空间与清晰沟通的情侣，特别是其中一方或双方在传统即时通讯中容易感到压力的人群。  
**设计哲学**："拉取"而非"推送"；提供"确定性"而非"催促"；赋予"控制权"而非施加"要求"。  
**最低支持版本**：**iOS 15.6**

## 二、整体架构与界面布局

App采用经典的**底部标签栏 (Tab Bar)** 导航，分为三个核心空间：

### 1. 「我的空间」 (My Space) - 默认首页
**功能**：**管理自我**。所有以"我"为中心的功能集中于此。

**布局**：
- **顶部状态区**：显示用户自己的当前状态（大号🟢/🟡/🔴图标）和「专注模式」开关
- **功能卡片区**：从上至下排列「能量预规划」、「焦虑平复指南」、「知行合一」、「我的动态」等功能入口
- **悬浮按钮 (FAB)**：右下角"+"按钮。点击后弹出菜单，包含：【发起邀请】、【送达通知】、【赠送心意】、【分享碎片】、【发布瞬间】。**这是所有对外发起动作的总入口**

### 2. 「我们的空间」 (Our Space)
**功能**：**处理协作与共享**。一个**只读的、需要用户主动拉取信息**的仪表盘。

**布局**：
- **顶部状态区**：显示伴侣的当前状态
- **信息列表区**：卡片列表形式展示"待我处理"和"我发起的"事项
- **伴侣信息区**：折叠卡片形式展示"情绪报告"、"近日安排"、"TA的分享"（碎片收件箱入口）、"TA的动态"
- **共同记录区**：放置「Maybe清单」和「成长花园」

### 3. 「个人中心」 (Profile)
**功能**：**进行设置**。

**布局**：列表形式。包含：账号设置、关系管理、通知配置、工具盒（内含「冷静空间」）

## 三、功能清单与细节

### 「我的空间」 Tab - (管理自我)

#### 1. 能量信号 (Energy Signal)
- **描述**：每日设置基础情绪能量状态（🟢/🟡/🔴）
- **UI/逻辑**：大图标展示在首页顶部。状态变更后，伴侣端同步更新（仅展示）

#### 2. 专注模式 (Focus Mode)
- **描述**：临时开启免打扰时段
- **UI/逻辑**：首页顶部开关（🌙）。开启后全App静音，并向伴侣端发送提示

#### 3. 能量快充 (Energy Boost)
- **描述**：在低能量日临时开启沟通窗口
- **UI/逻辑**：在状态为🟡/🔴时，在「能量信号」区域显示快捷入口。开启后状态临时变🟢

#### 4. 能量预规划 (Energy Planner)
- **描述**：为未来时间段预约低能量状态
- **UI/逻辑**：功能卡片，点击进入日历视图进行规划

#### 5. 焦虑平复指南 (Anxiety Soothing Guide)
- **描述**：私密的自我安抚工具集
- **UI/逻辑**：功能卡片。在App顶部状态栏有常驻图标，通过柔和动画提示（如呼吸光晕），用户需主动点击进入

#### 6. 知行合一 (Action & Knowledge)
- **描述**：私密的个人目标与习惯管理
- **UI/逻辑**：功能卡片。点击进入私人目标列表/打卡页

#### 7. 我的动态 (My Moments)
- **描述**：查看自己发布的所有"瞬间"
- **UI/逻辑**：功能卡片。点击进入列表页，管理本人发布的内容

#### 8. 心情快照 (Mood Snapshot)
- **描述**：私密的每日轻量情绪记录
- **UI/逻辑**：在首页提供快速记录入口（滑动条）

### FAB 发起的次级页面

#### 9. 协作邀请创建页 (New Collaboration Invitation)
- **触发**：点击FAB -> 【发起邀请】
- **UI/逻辑**：表单页。包含标题、内容、可选时间等字段。**提交时校验：无法发起24小时内的邀请**

#### 10. 安心闭环创建页 (New Peaceful Closure)
- **触发**：点击FAB -> 【送达通知】
- **UI/逻辑**：表单页。包含物品、地点、预计时间等字段。极度简化，去情感化文案

#### 11. 心意盒创建页 (New Gift Box)
- **触发**：点击FAB -> 【赠送心意】
- **UI/逻辑**：表单页。提供多个选项（物品、时间、地点）让用户填写。设置有效期（默认7天）

#### 12. 碎片发送页 (New Fragment)
- **触发**：点击FAB -> 【分享碎片】
- **UI/逻辑**：简易编辑器。可添加图片、链接或短文字。每日最多发送2个

#### 13. 瞬间发布页 (New Moment)
- **触发**：点击FAB -> 【发布瞬间】
- **UI/逻辑**：编辑器。可添加图片和文案。**有清晰提示："文案将默认对伴侣隐藏3天"**

### 「我们的空间」 Tab - (处理协作与共享)

#### 14. 情绪图谱 (Emotion Map)
- **描述**：查看伴侣共享的周期性情绪评估摘要
- **UI/逻辑**：通过**推送触发评估**。评估完成后，结果以卡片形式静默出现在"伴侣信息区"

#### 15. 协作邀请列表页 (Collaboration Invitation List)
- **描述**：处理"协作邀请"
- **UI/逻辑**：在"待我处理"和"我发起的"列表中查看。对方可选：【好】、【再商量】、【以后再说】、【微信商量】

#### 16. 安心闭环列表页 (Peaceful Closure List)
- **描述**：处理"安心闭环"
- **UI/逻辑**：在"待我处理"和"我发起的"列表中查看。接收方点击【已知悉】即完成闭环

#### 17. 心意盒列表页 (Gift Box List)
- **描述**：处理"心意盒"
- **UI/逻辑**：在"待我处理"和"我发起的"列表中查看。**有效期7天**，过期静默移除

#### 18. 碎片收件箱页 (Fragment Inbox)
- **描述**：异步批量处理分享信息
- **UI/逻辑**：入口在"伴侣信息区"。**仅当用户自身状态为🟢时，入口才亮起可点击**

#### 19. 瞬间浏览页 (Moments Feed)
- **描述**：查看伴侣发布的动态
- **UI/逻辑**：在"伴侣信息区"展示。**文案默认隐藏3天**，3天后自动公开。**用户状态为🔴时，隐藏此板块**

#### 20. Maybe清单 (Maybe List)
- **描述**：无压力的共同愿望灵感记录
- **UI/逻辑**：位于"我们的空间"的**共同记录区**。双方可随时编辑。**无任何通知**

#### 21. 成长花园 (Growth Garden)
- **描述**：关系积极互动的抽象可视化
- **UI/逻辑**：位于"我们的空间"的**共同记录区**。采用"共养植物"等抽象可视化，**无数字**

### 「个人中心」 Tab - (设置与管理)

#### 22. 关系管理 (Relationship Management)
- **描述**：核心设置功能。邀请或解除伴侣关系
- **UI/逻辑**：在「个人中心」以列表项形式存在。通过生成邀请链接实现绑定

#### 23. 冷静空间 (Calm Space)
- **描述**：为外部冲突提供结构化暂停工具
- **UI/逻辑**：位于「个人中心」的"工具盒"内。提供生成"暂停对话"文案等功能

## 四、核心技术栈与框架 (iOS 15.6+)

- **语言**: **Swift**
- **UI框架**: **SwiftUI** (主体) + **UIKit** (必要时兼容)
- **架构模式**: **MVVM**
- **数据持久化 (本地)**: **Core Data**
- **网络与同步**: **CloudKit** (首选)
- **推送通知**: **APNs via CloudKit**
- **依赖管理**: **Swift Package Manager (SPM)**

## 五、全局规则

1. **通知规则**: **默认关闭所有通知**。用户可手动在「个人中心」-「通知设置」中为特定功能开启
2. **状态联动规则**: "我们的空间"内容的**可访问性与用户自身的当前能量状态绑定**
3. **无红点规则**: 禁止使用未读数字角标（红点）
4. **数据共享规则**: 所有数据默认私有。共享数据遵循"最小化"和"用户可控"原则

## 六、技术实现要点

### 数据模型设计
- 用户状态管理（能量信号、专注模式）
- 关系绑定与邀请机制
- 各种内容类型的数据结构（邀请、闭环、心意盒、碎片、瞬间等）
- 本地缓存与CloudKit同步策略

### 状态管理
- 全局状态管理（用户状态、关系状态）
- 各Tab页面的状态管理
- 数据同步状态管理

### 用户体验设计
- 无压力交互设计
- 状态驱动的UI显示逻辑
- 异步加载与缓存策略
- 错误处理与用户反馈

## 七、开发里程碑

### Phase 1: 基础架构
- [ ] 项目初始化与基础架构搭建
- [ ] 底部Tab导航实现
- [ ] 基础数据模型设计
- [ ] Core Data + CloudKit集成

### Phase 2: 我的空间核心功能
- [ ] 能量信号系统
- [ ] 专注模式实现
- [ ] 基础功能卡片
- [ ] FAB菜单与次级页面

### Phase 3: 我们的空间
- [ ] 伴侣状态显示
- [ ] 信息列表管理
- [ ] 各种内容类型处理
- [ ] 共同记录功能

### Phase 4: 个人中心与设置
- [ ] 关系管理功能
- [ ] 通知设置
- [ ] 工具盒功能

### Phase 5: 优化与测试
- [ ] 性能优化
- [ ] 用户体验优化
- [ ] 全面测试
- [ ] App Store准备

---

**文档版本**: v1.0  
**创建日期**: 2025年1月  
**最后更新**: 2025年1月
